Portfolio 2
================
Thomas Huang
2026-02-06

This portfolio piece aims to visualize a scree plot or an elbow plot for
LCA model selection with Mplus out files.

# Load packages

``` r
library(tidyverse);library(MplusAutomation);library(cowplot)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.6
    ## ✔ forcats   1.0.1     ✔ stringr   1.6.0
    ## ✔ ggplot2   4.0.1     ✔ tibble    3.3.1
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.2
    ## ✔ purrr     1.2.1     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
    ## Version:  1.2
    ## We work hard to write this free software. Please help us get credit by citing: 
    ## 
    ## Hallquist, M. N. & Wiley, J. F. (2018). MplusAutomation: An R Package for Facilitating Large-Scale Latent Variable Analyses in Mplus. Structural Equation Modeling, 25, 621-638. doi: 10.1080/10705511.2017.1402334.
    ## 
    ## -- see citation("MplusAutomation").
    ## 
    ## 
    ## Attaching package: 'cowplot'
    ## 
    ## 
    ## The following object is masked from 'package:lubridate':
    ## 
    ##     stamp

# Read Mplus out files

``` r
for (i in 1:8){
  assign(paste0("lca_", i, "c"), readModels(paste0("LCA_", i, ".out")))
}
```

    ## No PROPORTION OF DATA PRESENT sections found within COVARIANCE COVERAGE OF DATA output.

    ## Error reading SAVEDATA rawfile: LCA_1_out.dat in output file: LCA_1.out

    ## <simpleError in fread(savedataFile, header = F, sep = "\n", strip.white = FALSE): File 'LCA_1_out.dat' does not exist or is non-readable. getwd()=='/Users/roberthuang/Desktop/Wake/Spring 2026/DSPsych/dspych_portfolio/p02'>

    ## No PROPORTION OF DATA PRESENT sections found within COVARIANCE COVERAGE OF DATA output.

    ## Error reading SAVEDATA rawfile: LCA_2_out.dat in output file: LCA_2.out

    ## <simpleError in fread(savedataFile, header = F, sep = "\n", strip.white = FALSE): File 'LCA_2_out.dat' does not exist or is non-readable. getwd()=='/Users/roberthuang/Desktop/Wake/Spring 2026/DSPsych/dspych_portfolio/p02'>

    ## No PROPORTION OF DATA PRESENT sections found within COVARIANCE COVERAGE OF DATA output.

    ## Error reading SAVEDATA rawfile: LCA_3_out.dat in output file: LCA_3.out

    ## <simpleError in fread(savedataFile, header = F, sep = "\n", strip.white = FALSE): File 'LCA_3_out.dat' does not exist or is non-readable. getwd()=='/Users/roberthuang/Desktop/Wake/Spring 2026/DSPsych/dspych_portfolio/p02'>

    ## No PROPORTION OF DATA PRESENT sections found within COVARIANCE COVERAGE OF DATA output.

    ## Error reading SAVEDATA rawfile: LCA_4_out.dat in output file: LCA_4.out

    ## <simpleError in fread(savedataFile, header = F, sep = "\n", strip.white = FALSE): File 'LCA_4_out.dat' does not exist or is non-readable. getwd()=='/Users/roberthuang/Desktop/Wake/Spring 2026/DSPsych/dspych_portfolio/p02'>

    ## No PROPORTION OF DATA PRESENT sections found within COVARIANCE COVERAGE OF DATA output.

    ## Error reading SAVEDATA rawfile: LCA_5_out.dat in output file: LCA_5.out

    ## <simpleError in fread(savedataFile, header = F, sep = "\n", strip.white = FALSE): File 'LCA_5_out.dat' does not exist or is non-readable. getwd()=='/Users/roberthuang/Desktop/Wake/Spring 2026/DSPsych/dspych_portfolio/p02'>

    ## No PROPORTION OF DATA PRESENT sections found within COVARIANCE COVERAGE OF DATA output.

    ## Error reading SAVEDATA rawfile: LCA_6_out.dat in output file: LCA_6.out

    ## <simpleError in fread(savedataFile, header = F, sep = "\n", strip.white = FALSE): File 'LCA_6_out.dat' does not exist or is non-readable. getwd()=='/Users/roberthuang/Desktop/Wake/Spring 2026/DSPsych/dspych_portfolio/p02'>

    ## No PROPORTION OF DATA PRESENT sections found within COVARIANCE COVERAGE OF DATA output.

    ## Error reading SAVEDATA rawfile: LCA_7_out.dat in output file: LCA_7.out

    ## <simpleError in fread(savedataFile, header = F, sep = "\n", strip.white = FALSE): File 'LCA_7_out.dat' does not exist or is non-readable. getwd()=='/Users/roberthuang/Desktop/Wake/Spring 2026/DSPsych/dspych_portfolio/p02'>

    ## No PROPORTION OF DATA PRESENT sections found within COVARIANCE COVERAGE OF DATA output.

    ## Error reading SAVEDATA rawfile: LCA_8_out.dat in output file: LCA_8.out

    ## <simpleError in fread(savedataFile, header = F, sep = "\n", strip.white = FALSE): File 'LCA_8_out.dat' does not exist or is non-readable. getwd()=='/Users/roberthuang/Desktop/Wake/Spring 2026/DSPsych/dspych_portfolio/p02'>

# Extract model fit indices

``` r
df_summaries <- bind_rows(
          lca_1c$summaries, 
          lca_2c$summaries,
          lca_3c$summaries,
          lca_4c$summaries,
          lca_5c$summaries,
          lca_6c$summaries,
          lca_7c$summaries,
          lca_8c$summaries
          )

colnames(df_summaries)
```

    ##  [1] "Mplus.version"          "Title"                  "AnalysisType"          
    ##  [4] "DataType"               "Estimator"              "Observations"          
    ##  [7] "NGroups"                "NDependentVars"         "NIndependentVars"      
    ## [10] "NContinuousLatentVars"  "NCategoricalLatentVars" "Parameters"            
    ## [13] "LL"                     "LLCorrectionFactor"     "AIC"                   
    ## [16] "BIC"                    "aBIC"                   "AICC"                  
    ## [19] "Filename"               "NLatentClasses"         "Entropy"               
    ## [22] "T11_KM1Starts"          "T11_KM1Final"           "T11_KM1LL"             
    ## [25] "T11_VLMR_2xLLDiff"      "T11_VLMR_ParamDiff"     "T11_VLMR_Mean"         
    ## [28] "T11_VLMR_SD"            "T11_VLMR_PValue"        "T11_LMR_Value"         
    ## [31] "T11_LMR_PValue"         "BLRT_RequestedDraws"    "BLRT_KM1AnalysisStarts"
    ## [34] "BLRT_KM1AnalysisFinal"  "BLRT_KM1GenStarts"      "BLRT_KM1GenFinal"      
    ## [37] "BLRT_KGenStarts"        "BLRT_KGenFinal"         "BLRT_KM1LL"            
    ## [40] "BLRT_2xLLDiff"          "BLRT_ParamDiff"         "BLRT_PValue"           
    ## [43] "BLRT_SuccessfulDraws"

``` r
# Select the columns for model fit
df_summaries <- df_summaries %>% 
  dplyr::select(NLatentClasses, Parameters, LL, AIC:aBIC, Entropy, T11_VLMR_PValue, BLRT_PValue)

df_summaries
```

    ##   NLatentClasses Parameters        LL      AIC      BIC     aBIC Entropy
    ## 1              1         32 -16713.83 33491.66 33674.89 33573.22      NA
    ## 2              2         65 -13341.67 26813.35 27185.53 26979.01   0.910
    ## 3              3         98 -12085.16 24366.31 24927.44 24616.07   0.945
    ## 4              4        131 -11461.19 23184.38 23934.46 23518.25   0.959
    ## 5              5        164 -11227.94 22783.88 23722.91 23201.85   0.962
    ## 6              6        197 -11007.95 22409.90 23537.88 22911.98   0.966
    ## 7              7        230 -10806.29 22072.59 23389.52 22658.77   0.953
    ## 8              8        263 -10627.77 21781.55 23287.43 22451.83   0.926
    ##   T11_VLMR_PValue BLRT_PValue
    ## 1              NA          NA
    ## 2          0.0000           0
    ## 3          0.0000           0
    ## 4          0.0000           0
    ## 5          0.0001           0
    ## 6          0.0173           0
    ## 7          0.4968           0
    ## 8          0.0509           0

# Convert model fit to long format

``` r
df_summaries_long <- df_summaries %>% 
  mutate(`-2LL` = -2*LL) %>% 
  pivot_longer(cols = c(AIC, BIC, aBIC, `-2LL`),
               names_to = "Index",
               values_to = "Value"
  ) %>% 
  dplyr::select(NLatentClasses, Index, Value)

glimpse(df_summaries_long)
```

    ## Rows: 32
    ## Columns: 3
    ## $ NLatentClasses <int> 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5…
    ## $ Index          <chr> "AIC", "BIC", "aBIC", "-2LL", "AIC", "BIC", "aBIC", "-2…
    ## $ Value          <dbl> 33491.66, 33674.89, 33573.22, 33427.66, 26813.35, 27185…

# Plot

``` r
plot <- ggplot(df_summaries_long, 
               aes(x = NLatentClasses, 
                   y = Value,
                  shape = Index,
                  colour = Index,
                  linetype = Index
                )) + 
                geom_point(size = 4) +
                geom_line() +
                theme_cowplot() +
                labs(x = "Number of classes", y = "Value") + 
                theme(
                  text = element_text(size = 12), 
                  legend.key.width = unit(.5, "line"), 
                  legend.text = element_text(size = 12), 
                  legend.title = element_blank(), 
                  legend.position = "right"
                 )

plot
```

![](p02_files/figure-gfm/plot-1.png)<!-- -->
